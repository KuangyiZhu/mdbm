Name:           mdbm
Version:        VERSION
Release:        1%{?dist}
Summary:        MDBM is a fast dbm clone originally based on Ozan Yigit's sdbm.
BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)


License:        BSD
URL:            https://github.com/yahoo/mdbm
Source0:        mdbm-VERSION-0.tgz

BuildRequires:  readline-devel, cppunit-devel
Requires:       openssl


%description

%define _unpackaged_files_terminate_build 1

%package devel
Summary:        Mdbm header files.

%description devel

%package perl
Summary:        Mdbm perl wrappers
%description perl


%prep
%setup -qn %{name}-VERSION-0

%build
make %{?_smp_mflags} LIBDIR=/usr/lib64 INCDIR=/usr/include


%install
rm -rf %{buildroot}
#mdbm installs directly to prefix, rpm looks for /usr
make PREFIX=%{buildroot}/usr PERL_PREFIX=%{buildroot}/usr LIBDIR=%{buildroot}/usr/lib64 INCDIR=%{buildroot}/usr/include  install-all

%files
%doc README LICENSE
%{_bindir}/*
%{_libdir}/*
%{_mandir}/man1/*
#%exclude %{_mandir}/man3/*
%exclude /usr/lib/perl5/*

%files devel
%{_includedir}/*

%files perl
/usr/man/man3/MDBM_File.3pm.gz
/usr/lib/perl5/*
%exclude /usr/lib/perl5/x86_64-linux-thread-multi/perllocal.pod

%post -p /sbin/ldconfig
%postun -p /sbin/ldconfig

%changelog
